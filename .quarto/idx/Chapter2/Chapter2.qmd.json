{"title":"Model Exploration","markdown":{"yaml":{"title":"Model Exploration"},"headingText":"load gardnerjanson_museums","containsRefs":false,"markdown":"\n\n```{r load-pkg}\n\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(lme4)\nlibrary(MASS)\nlibrary(car)\nlibrary(MuMIn)\nlibrary(lmerTest)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(broom.mixed)\n\ngardnerjanson_museums <- read_csv(\"gardnerjanson_museums.csv\")\n```\n\n# Data Preparation for Modeling:\n\n```{r raceprep}\ngardnerjanson_museums <- gardnerjanson_museums %>%\n  mutate(artist_race_nwi = if_else(artist_race == \"White\", \"white\", \"non-white\"))%>%\n  filter(!startsWith(artist_name, \"N/A\")) %>%\n  mutate(artist_gender = if_else(artist_name == \"Mele Sitani\", \"Female\", artist_gender))\n```\n\nRELEVEL VARIABLES\n\n# Model Exploration:\n\n```{r fixedeffects}\nmodel <- lm(log(space_ratio_per_page_total) ~ artist_race_nwi\n                       + artist_ethnicity \n                       + artist_gender \n                       + artist_nationality_other\n                       + moma_count_to_date\n                       + whitney_count_to_date, \n            data = gardnerjanson_museums)\n```\n\npick a handful of interest\n\nvisualization : confidence intervals for each on of the slopes\n\npredictors on the y axis -\n\nbar plots of the pvalues another option\n\nnationality discourse for significance\n\nlog transformation on the y variable -\n\nstepwise model selection\n\n```{r newmodel}\n#newmodel<- stats::step(model)\n\nnewmodel<- stepAIC(model, scope=list(upper= ~artist_gender*artist_race_nwi*artist_nationality_other*artist_ethnicity*moma_count_to_date*whitney_count_to_date, lower= ~1))\n```\n\nthe multiple of the number of degrees of freedom used for the penalty. Only k = 2 gives the genuine AIC: k = log(n) is sometimes referred to as BIC or SBC.\n\n```{r BICnewmodel}\nn <- nrow(gardnerjanson_museums)\n\nnewmodel<- stepAIC(model, k = log(n), scope=list(upper= ~artist_gender*artist_race_nwi*artist_nationality_other*artist_ethnicity*moma_count_to_date*whitney_count_to_date, lower= ~1))\n\n```\n\n```{r lowestAIC}\nlmm_model <- lmer(log(space_ratio_per_page_total) ~ artist_race\n                       + artist_ethnicity \n                       + artist_gender \n                       + artist_nationality_other\n                       + moma_count_to_date\n                       + whitney_count_to_date\n                       + artist_gender*moma_count_to_date\n                       + artist_nationality_other*moma_count_to_date +\n                         (1 | artist_name),\n            data = gardnerjanson_museums,\n    REML = FALSE)\nsummary(lmm_model)\n\n```\n\n```{r collinearity}\nvif(lmm_model)\n```\n\nGET PVALUES FOR COEFFICIENTS - STATISTICALLY SIGNIFICANT - GO THROUGH INTERPRETATIONS WITH LOG TRANSFORMATION AND MIXED EFFECTS MODEL - CONFIRM MODEL DIAGNOSTICS - AIC / BIC FOR MIXED EFFECTS -\n\n```{r lmerTest}\n\nsummary(lmm_model, ddf = \"Satterthwaite\")\n\n```\n\n```{r rsq}\nr.squaredGLMM(lmm_model)\n```\n\nMarginal R2 provides the variance explained only by fixed effects and conditional R2 provides the variance explained by the entire model, i.e., both fixed effects and random effects.\n\n```{r}\n#create vector of VIF values\n#vif_values <- vif(lmm_model)$`GVIF^(1/(2*Df))`\n\n#create horizontal bar chart to display each VIF value\n#barplot(vif_values, main = \"VIF Values\", horiz = TRUE, col = \"steelblue\")\n\n#add vertical line at 5\n#abline(v = 5, lwd = 3, lty = 2)\n```\n\nModel Diagnostics : Check for linearity, independence, residuals, normal distribution of the residuals - no pattern in residuals, constant variance\n\nRESOURCE: https://www.ssc.wisc.edu/sscc/pubs/MM/MM_DiagInfer.html\n\nPlotting : log transform some variables : Fitted v. Residuals\n\n# Appendix:\n\n## Assumptions:\n\n### Residuals and Constant Variance:\n\n```{r diagnostics}\n\nplot(resid(lmm_model, type = \"pearson\") ~ fitted(lmm_model))\n```\n\nfor the very low values of the predicted have very low variability for residuals - the rest varied\n\nthe a bulk of the data there is constant variability in the residuals\n\nbefore log transforming our outcome variable, the constant variance assumption was violated. Therefore, in order to pass the constant variance assumption, I performed a log transformation.\n\n### Normality:\n\nnormal histogram = density plot overlayed -\n\n```{r}\n#| label: density-histogram\n\n#lmm_model_aug <- augment(lmm_model$fit)\n\n#ggplot(lmm_model_aug, aes(x = .resid))+\n # geom_histogram(binwidth = 50, aes(y = after_stat(density)))+\n # theme_minimal()+ \n # stat_function(fun = dnorm,\n  #              args = list(mean = mean(lmm_model_aug$.resid),\n  #                          sd = sd(lmm_model_aug$.resid)),\n  #              color = \"red\",\n  #              size = 2)\n```\n\n```{r normal}\n\nqqnorm(resid(lmm_model, type = \"pearson\"))\nqqline(resid(lmm_model, type = \"pearson\"))\n\n```\n\n### Linearity:\n\nresiduals v quantitative predictors\n\nno pattern is left behind\n\n```{r linearitymoma}\n\nggplot(gardnerjanson_museums, aes(x = moma_count_to_date, y = log(space_ratio_per_page_total))) +\n  geom_point(position=position_jitter(h=0.1, w=0.1), alpha = 0.5, size = 1) +\n  geom_smooth(method = \"lm\", se = FALSE)+\n  labs(\n    title = \"Log of \n    Ratio of Space Per Artist Per Edition by\\nNumber of Exhibitions per Artist per Editions in the MoMA\",\n    x = \"Count to Date\",\n    y = \"Ratio of Space Per Artist Per Edition\"\n  )\n```\n\n```{r linearitywhitney}\n\nggplot(gardnerjanson_museums, aes(x = whitney_count_to_date, y = log(space_ratio_per_page_total))) +\n  geom_point(position=position_jitter(h=0.1, w=0.1), alpha = 0.5, size = 1) +\n  geom_smooth(method = \"lm\", se = FALSE)+\n  labs(\n    title = \"Log of Ratio of Space Per Artist Per Edition by\\nNumber of Exhibitions per Artist per Editions in the Whitney\",\n    x = \"Count to Date\",\n    y = \"Ratio of Space Per Artist Per Edition\"\n  )\n```\n\nNormality of random effect: Get the estimate of random effect (in your case random intercepts), and check them as check the residual. But it is not efficient because you just have 7 random intercepts.\n\n### Independence:\n\nAnother assumption is the independence between subjects. No test, based on your judgement. Subject specific random intercept means the correlation between the response variable from the same subject are the same.\n\nall obervations of different artists are independent -\n\nfitting a mixed model - i dont believe that each piece by each artist is independence - at the artist level we have independence\n\nlog transforming predictors - interpretations change - variables weren't changed - same idea, bit different\n\nINDEPENDENCE: DOUBLE CHECK - EMPIRICALLY ARGUE OR ?\n\ncheck for time series - residuals v. order of data points\n\nirrelevant - based on how the sample was collected.\n\nverbally argue the independence between artists - since we are using a mixed effects model, and our random effect is per artist, we eliminate the dependence of our observations had we not used a mixed effects model. Between artists, we expect the observations to be independent.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"self-contained-math":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"Chapter2.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"bibliography":["../references.bib"],"editor":"visual","theme":"cosmo","title":"Model Exploration"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":6.5,"fig-height":4.5,"fig-format":"pdf","fig-dpi":300,"error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"self-contained-math":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"Chapter2.pdf"},"language":{},"metadata":{"bibliography":["../references.bib"],"editor":"visual","documentclass":"scrreprt","title":"Model Exploration"},"extensions":{"book":{}}}}}