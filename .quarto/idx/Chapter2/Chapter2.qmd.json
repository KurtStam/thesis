{"title":"Model Exploration","markdown":{"yaml":{"title":"Model Exploration"},"headingText":"load gardnerjanson_museums","containsRefs":false,"markdown":"\n\n```{r load-pkg}\n\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(lme4)\nlibrary(MASS)\nlibrary(car)\nlibrary(MuMIn)\nlibrary(lmerTest)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(broom.mixed)\nlibrary(forcats)\nlibrary(sjPlot)\n\ngardnerjanson_museums <- read_csv(\"gardnerjanson_museums.csv\")\n```\n\n# Data Preparation for Modeling:\n\n```{r}\n#| label: lmm_prep\n#| echo: false\n\ngardnerjanson_museums_mod <- gardnerjanson_museums %>%\n  filter(!startsWith(artist_name, \"N/A\"))%>%\n  mutate(artist_race_nwi = if_else(artist_race == \"White\", \"White\", \"Non-White\"))%>%\n  mutate(artist_nationality_other = fct_relevel(artist_nationality_other, c(\"American\", \n                                                                            \"French\", \n                                                                            \"Other\", \n                                                                            \"British\", \n                                                                            \"German\", \n                                                                            \"Spanish\")), \n         artist_race_nwi = fct_relevel(artist_race_nwi, c(\"White\", \"Non-White\")),\n         artist_ethnicity = fct_relevel(artist_ethnicity, c(\"Not Hispanic or Latinx\",\n                                                            \"Hispanic or Latinx\")),\n         artist_gender = fct_relevel(artist_gender, c(\"Male\", \"Female\")))%>%\n  dplyr::select(-\"...1\", \"moma_count\", \"whitney_count\")\n\n```\n\n```{r}\n#| label: nationality_tally\n#| echo: false\n\ngardnerjanson_museums%>%\n   group_by(artist_nationality_other) %>%\n   tally()\n```\n\n# Model Exploration:\n\n```{r}\n#| label: lmm_full\n#| echo: false\n\nlmm_full <- lmer(log(space_ratio_per_page_total) ~ artist_race_nwi\n                       + artist_ethnicity \n                       + artist_gender \n                       + artist_nationality_other\n                       + moma_count_to_date\n                       + whitney_count_to_date +\n                         (1 | artist_name),\n            data = gardnerjanson_museums,\n    REML = FALSE)\n```\n\n    ddf=\"Satterthwaite\"\n\nSatterthwaite test, more flexible, looking directly at p-values - non-parametric test - uses different error term, similar to a two same t-test, similar to ANOVA - analysis of variance - checking between different groups -\n\n```{r}\n#| label: lmm_test\n#| echo: false\n\nlmm <- lmer(log(space_ratio_per_page_total) ~ artist_race_nwi\n                       + artist_ethnicity \n                       + artist_gender \n                       + artist_nationality_other\n                       + moma_count_to_date\n                       + whitney_count_to_date\n                       + artist_nationality_other*moma_count_to_date\n                       + artist_race_nwi*moma_count_to_date\n                       + artist_ethnicity*moma_count_to_date\n                       + artist_race_nwi*whitney_count_to_date\n                       + artist_ethnicity*whitney_count_to_date\n                  + (1 | artist_name),\n            data = gardnerjanson_museums,\n    REML = FALSE)\n```\n\n```{r}\n#| label: lmm_step\n#| echo: false\n\nlmerTest::step(lmm)\n```\n\npick a handful of interest\n\nvisualization : confidence intervals for each on of the slopes\n\npredictors on the y axis -\n\nbar plots of the pvalues another option\n\nnationality discourse for significance\n\nlog transformation on the y variable -\n\nstepwise model selection\n\nthe multiple of the number of degrees of freedom used for the penalty. Only k = 2 gives the genuine AIC: k = log(n) is sometimes referred to as BIC or SBC.\n\n```{r}\n#| label: lmm\n#| echo: false\n\nlmm <- lmer(log(space_ratio_per_page_total) ~ artist_nationality_other\n                       + moma_count_to_date\n                       + artist_nationality_other*moma_count_to_date\n                        + (1 | artist_name),\n            data = gardnerjanson_museums,\n    REML = FALSE)\nsummary(lmm)\n```\n\n# 7.0 Results\n\n```{r}\n#| label: sjplot\n#| echo: false\n\nsjPlot::plot_model(lmm, \n                   axis.labels=c(\"Spanish x MoMA Count to Date\",\n                                 \"German x MoMA Count to Date\",\n                                 \"British x MoMA Count to Date\",\n                                 \"Other x MoMA Count to Date\", \n                                 \"French x MoMA Count to Date\",\n                                 \"MoMA Count to Date\",\n                                 \"Spanish\",\n                                 \"German\",\n                                 \"British\",\n                                 \"Nationality Other\",\n                                 \"French\"),\n                   show.values=TRUE, show.p=TRUE,\n                   title=\"Effect of Artist Nationality and the Number of Exhibitions Held at the MoMA per Artist per Edition on the Total Space Ratio per Page\")\n```\n\n```{r}\n#| label: collinearity\n#| echo: false\n\nvif(lmm)\n```\n\nGET PVALUES FOR COEFFICIENTS - STATISTICALLY SIGNIFICANT - GO THROUGH INTERPRETATIONS WITH LOG TRANSFORMATION AND MIXED EFFECTS MODEL - CONFIRM MODEL DIAGNOSTICS - AIC / BIC FOR MIXED EFFECTS -\n\n```{r rsq}\nr.squaredGLMM(lmm)\n```\n\nMarginal R2 provides the variance explained only by fixed effects and conditional R2 provides the variance explained by the entire model, i.e., both fixed effects and random effects.\n\nModel Diagnostics : Check for linearity, independence, residuals, normal distribution of the residuals - no pattern in residuals, constant variance\n\nRESOURCE: https://www.ssc.wisc.edu/sscc/pubs/MM/MM_DiagInfer.html\n\nPlotting : log transform some variables : Fitted v. Residuals\n\n# 8.0 Discussion:\n\n# 9.0 Limitations and Next Steps:\n\n# 10.0 Appendix:\n\n## 10.1 Assumptions:\n\n### 10.1.1 Residuals and Constant Variance:\n\n```{r diagnostics}\n\nplot(resid(lmm, type = \"pearson\") ~ fitted(lmm))\n```\n\nfor the very low values of the predicted have very low variability for residuals - the rest varied\n\nthe a bulk of the data there is constant variability in the residuals\n\nbefore log transforming our outcome variable, the constant variance assumption was violated. Therefore, in order to pass the constant variance assumption, I performed a log transformation.\n\n### 10.1.2 Normality:\n\nnormal histogram = density plot overlayed -\n\nStruggling to understand how to do this with a mixed-effects model\n\n```{r}\n#| label: density-histogram\n\n#lmm_aug <- augment(lmm$fit)\n\n#ggplot(lmm_model_aug, aes(x = .resid))+\n # geom_histogram(binwidth = 50, aes(y = after_stat(density)))+\n # theme_minimal()+ \n # stat_function(fun = dnorm,\n  #              args = list(mean = mean(lmm_model_aug$.resid),\n  #                          sd = sd(lmm_model_aug$.resid)),\n  #              color = \"red\",\n  #              size = 2)\n```\n\n```{r normal}\n\nqqnorm(resid(lmm, type = \"pearson\"))\nqqline(resid(lmm, type = \"pearson\"))\n```\n\n### 10.1.3 Linearity:\n\nresiduals v quantitative predictors\n\nonce i figure out how to augment the data and get the .resid I can make this visualization as well\n\nno pattern is left behind\n\n```{r linearitymoma}\n\nggplot(gardnerjanson_museums, aes(x = moma_count_to_date, y = log(space_ratio_per_page_total))) +\n  geom_point(position=position_jitter(h=0.1, w=0.1), alpha = 0.5, size = 1) +\n  geom_smooth(method = \"lm\", se = FALSE)+\n  labs(\n    title = \"Log of \n    Ratio of Space Per Artist Per Edition by\\nNumber of Exhibitions per Artist per Editions in the MoMA\",\n    x = \"Count to Date\",\n    y = \"Ratio of Space Per Artist Per Edition\"\n  )\n```\n\n```{r linearitywhitney}\n\nggplot(gardnerjanson_museums, aes(x = whitney_count_to_date, y = log(space_ratio_per_page_total))) +\n  geom_point(position=position_jitter(h=0.1, w=0.1), alpha = 0.5, size = 1) +\n  geom_smooth(method = \"lm\", se = FALSE)+\n  labs(\n    title = \"Log of Ratio of Space Per Artist Per Edition by\\nNumber of Exhibitions per Artist per Editions in the Whitney\",\n    x = \"Count to Date\",\n    y = \"Ratio of Space Per Artist Per Edition\"\n  )\n```\n\nNormality of random effect: Get the estimate of random effect (in your case random intercepts), and check them as check the residual. But it is not efficient because you just have 7 random intercepts.\n\n### 10.1.4 Independence:\n\nAnother assumption is the independence between subjects. No test, based on your judgement. Subject specific random intercept means the correlation between the response variable from the same subject are the same.\n\nall obervations of different artists are independent -\n\nfitting a mixed model - i do not believe that pieces by each artist is independence - at the artist level we have independence\n\nlog transforming predictors - interpretations change - variables weren't changed - same idea, bit different\n\nINDEPENDENCE: DOUBLE CHECK - EMPIRICALLY ARGUE OR ?\n\ncheck for time series - residuals v. order of data points\n\nirrelevant - based on how the sample was collected.\n\nverbally argue the independence between artists - since we are using a mixed effects model, and our random effect is per artist, we eliminate the dependence of our observations had we not used a mixed effects model. Between artists, we expect the observations to be independent.\n\n## **10.2 Data Dictionary:**\n\nOutcome:\n\n`space_ratio_per_page_total` = The area in centimeters squared of both the text and the figure of a particular artist in a given edition of *Janson's History of Art* divided by the area in centimeters squared of a single page of the respective edition.\n\nPotential Predictors:\n\n`artist_gender` = The gender of the artist.\n\n`artist_race` = The race of the artist.\n\n`artist_race_nwi` = The non-white indicator for artist race, meaning if an artist's race is denoted as either white or non-white.\n\n`artist_ethnicity` = The ethnicity of the artist.\n\n`artist_nationality_other` = The nationality of the artist. Of the total count of artists through all editions of *Gardner's Art Through the Ages* and *Janson's History of Art*, 77.32% account for French, Spanish, British, American and German. Therefore, the categorical strings of this variable are French, Spanish, British, American, German and Other.\n\n`whitney_count_to_date` = The count of exhibitions held by The Whitney of a particular artist at a particular moment of time, as highlighted by `year`.\n\n`moma_count_to_date` = The count of exhibitions held by the Museum of Modern Art (MoMA) of a particular artist at a particular moment of time, as highlighted by `year`.\n\n`year` = The year of publication for a given edition of Janson or Gardner.\n\nOther variables:\n\n`edition_number` = The edition number of the textbook from either Janson's History of Art or Gardner's Art Through the Ages.\n\n`book` = Which book, either Janson or Gardner the particular artist at that particular time was included.\n\n`artist_unique_id` = A unique identifying number assigned to artists across books and editions denoted in alphabetical order.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"self-contained-math":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"Chapter2.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"bibliography":["../references.bib"],"editor":"visual","theme":"cosmo","title":"Model Exploration"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":6.5,"fig-height":4.5,"fig-format":"pdf","fig-dpi":300,"error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"self-contained-math":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"Chapter2.pdf"},"language":{},"metadata":{"bibliography":["../references.bib"],"editor":"visual","documentclass":"scrreprt","title":"Model Exploration"},"extensions":{"book":{}}}}}